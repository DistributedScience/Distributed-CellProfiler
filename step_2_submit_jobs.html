

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Step 2: Submit Jobs &#8212; DCP Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'step_2_submit_jobs';</script>
    <link rel="canonical" href="distributedscience.github.io/step_2_submit_jobs.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Passing Files to DCP" href="passing_files_to_DCP.html" />
    <link rel="prev" title="SQS QUEUE Information" href="SQS_QUEUE_information.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="overview.html">
  
  
  
  
  
  
    <p class="title logo__title">DCP Documentation</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="overview.html">
                    What is Distributed-CellProfiler?
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">FAQ</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="overview_2.html">What happens in AWS when I run Distributed-CellProfiler?</a></li>
<li class="toctree-l1"><a class="reference internal" href="costs.html">What does Distributed-CellProfiler cost?</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Running DCP</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="step_0_prep.html">Step 0: Prep</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="step_1_configuration.html">Step 1: Configuration</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="config_examples.html">config.py configuration examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="SQS_QUEUE_information.html">SQS QUEUE Information</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="current reference internal" href="#">Step 2: Submit Jobs</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="passing_files_to_DCP.html">Passing Files to DCP</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="step_3_start_cluster.html">Step 3: Start Cluster</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting_start_cluster.html">Troubleshooting startCluster</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="step_4_monitor.html">Step 4: Monitor</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Technical Guides</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="dashboard.html">AWS Cloudwatch Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="external_buckets.html">Using External Buckets</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_configuration.html">Advanced Configuration of DCP</a></li>
<li class="toctree-l1"><a class="reference internal" href="AWS_hygiene_scripts.html">AWS Hygiene Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting_runs.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="versions.html">Versions</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/distributedscience/distributed-cellprofiler" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/distributedscience/distributed-cellprofiler/edit/main/DCP-documentation/step_2_submit_jobs.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/distributedscience/distributed-cellprofiler/issues/new?title=Issue%20on%20page%20%2Fstep_2_submit_jobs.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/step_2_submit_jobs.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Step 2: Submit Jobs</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configuring-your-job-file">Configuring your job file</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alternate-job-submission-run-batch-general-py">Alternate job submission: run_batch_general.py</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#required-inputs">Required inputs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#required-input-for-cell-painting-gallery">Required input for Cell Painting Gallery</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plate-layout-flags">Plate layout flags</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overwrite-structural-defaults">Overwrite structural defaults</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overwrite-defaults-for-runs-using-load-data-csv-s-and-cppipe">Overwrite defaults (for runs using load data .csv’s and .cppipe)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overwrite-defaults-for-runs-using-h5-batch-files">Overwrite defaults (for runs using .h5 batch files)</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="step-2-submit-jobs">
<h1>Step 2: Submit Jobs<a class="headerlink" href="#step-2-submit-jobs" title="Permalink to this heading">#</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">#</a></h2>
<p>Distributed-CellProfiler works by breaking your analysis into a series of smaller jobs based on the metadata and groupings you’ve specified in your pipeline.
The choice of how to group your images is largely dependent on the details of your experiment.
For example, pipelines to create <a class="reference external" href="http://onlinelibrary.wiley.com/doi/10.1111/jmi.12178/full">illumination correction functions</a> are usually run on a per-plate basis, while pipelines with a large number of memory intensive measurement steps such as <a class="reference external" href="http://www.nature.com/nprot/journal/v11/n9/full/nprot.2016.105.html">CellPainting</a> are grouped based on plate, well, and site so that each node only analyzes one site at a time.</p>
<p>Once you’ve decided on a grouping, you’re ready to start configuring your job file.
Once your job file is configured, simply use <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">run.py</span> <span class="pre">submitJob</span> <span class="pre">files/{YourJobFile}.json</span></code> to send all the jobs to the SQS queue <a class="reference internal" href="step_1_configuration.html"><span class="doc std std-doc">specified in your config file</span></a>.</p>
<hr class="docutils" />
<p><strong>Distributed-CellProfiler only works for pipelines with extracted metadata and specified groupings and which use the LoadData OR on h5 containers created by the CreateBatchFiles module</strong>, though we hope to add support for file-lists in the future.
See <a class="reference external" href="https://github.com/CellProfiler/CellProfiler/wiki/Adapting-CellProfiler-to-a-LIMS-environment">this page</a> for more information about running CellProfiler headless with file-lists versus LoadData CSVs.</p>
<p><strong>The grouping specified in your pipeline MUST match what you specify here in order to successfully run jobs.</strong></p>
<p>Due to CellProfiler’s image-loading mechanisms, experiments with &gt;10,000 image sites can begin to suffer from decreased performance.
Breaking such experiments down into a number of smaller CSVs may increase your processing throughput.<br />
If using LoadData, make sure your “Base image location” is set to “None”.</p>
</section>
<hr class="docutils" />
<section id="configuring-your-job-file">
<h2>Configuring your job file<a class="headerlink" href="#configuring-your-job-file" title="Permalink to this heading">#</a></h2>
<ul>
<li><p><strong>pipeline:</strong> The path to your pipeline file.</p></li>
<li><p><strong>data_file:</strong> The path to your LoadData.csv, batch file, or file list file.</p></li>
<li><p><strong>input:</strong> The path to your default input directory.
This is not necessary for every pipeline but can be helpful when non-image files are needed in the pipeline (such as a text file containing quality control rules for the FlagImage module or a metadata file for use with file lists).
DO NOT set this to a large directory, or CellProfiler will try to scan the entire thing before running your pipeline.</p></li>
<li><p><strong>output:</strong> The top output directory you’d like your files placed in.</p></li>
<li><p><strong>output_structure:</strong> By default, Distributed-CellProfiler will put your output in subfolders created by hyphenating all your Metadata entries (see below) in order (e.g. if the individual group being processed was <code class="docutils literal notranslate"><span class="pre">{&quot;Metadata&quot;:</span> <span class="pre">&quot;Metadata_Plate=Plate1,Metadata_Well=A01&quot;}</span></code>, the output would be placed in <code class="docutils literal notranslate"><span class="pre">output_top_directory/Plate1-A01</span></code>.)
If you’d like a different folder structure, you may designate one here (e.g. if you set <code class="docutils literal notranslate"><span class="pre">&quot;output_structure&quot;:</span> <span class="pre">&quot;Metadata_Plate/Metadata_Well&quot;</span></code> then the previous example would output to <code class="docutils literal notranslate"><span class="pre">output_top_directory/Plate1/A01</span></code>.
This setting is optional.
Job files that don’t include it will use the default structure.</p></li>
<li><p><strong>groups:</strong> The list of all the groups of images you’d like to process.
For large numbers of groups, it may be helpful to create this list separately as a .txt file you can then append into the job’s JSON file.
You may create this yourself in your favorite scripting language.
Alternatively, you can use the following additional tools to help you create and format this list:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">batches.sh</span></code> allows you to provide a list of all the individual metadata components (plates, columns, rows, etc).
It then uses <a class="reference external" href="https://www.gnu.org/software/parallel/parallel_tutorial.html">GNU parallel</a> to create a formatted text file with all the possible combinations of the components you provided.
This approach is best when you have a large number of groups and the group structure is uniform.</p>
<p>Example: for a 96-well plate experiment where one there are 3 plates and the experiment is grouped by Plate and Well, <code class="docutils literal notranslate"><span class="pre">batches.sh</span></code> would read:
<code class="docutils literal notranslate"><span class="pre">parallel</span> <span class="pre">echo</span> <span class="pre">'{\&quot;Metadata\&quot;:</span> <span class="pre">\&quot;Metadata_Plate={1},Metadata_Well={2}{3}\&quot;},'</span> <span class="pre">:::</span> <span class="pre">Plate1</span> <span class="pre">Plate2</span> <span class="pre">Plate3</span> <span class="pre">:::</span> <span class="pre">A</span> <span class="pre">B</span> <span class="pre">C</span> <span class="pre">D</span> <span class="pre">E</span> <span class="pre">F</span> <span class="pre">G</span> <span class="pre">H</span> <span class="pre">:::</span> <span class="pre">01</span> <span class="pre">02</span> <span class="pre">03</span> <span class="pre">04</span> <span class="pre">05</span> <span class="pre">06</span> <span class="pre">07</span> <span class="pre">08</span> <span class="pre">09</span> <span class="pre">10</span> <span class="pre">11</span> <span class="pre">12</span> <span class="pre">|</span> <span class="pre">sort</span> <span class="pre">&gt;</span> <span class="pre">batches.txt</span></code></p>
</li>
<li><p>You may also use the list of groupings created by calling <code class="docutils literal notranslate"><span class="pre">cellprofiler</span> <span class="pre">--print-groups</span></code> from the command line (see <a class="reference external" href="https://github.com/CellProfiler/CellProfiler/wiki/Adapting-CellProfiler-to-a-LIMS-environment#cmd">here</a> and <a class="reference external" href="https://github.com/CellProfiler/Distributed-CellProfiler/issues/52">here</a> for more information).<br />
Note that for job files that specify groupings in this way, the <code class="docutils literal notranslate"><span class="pre">output_structure</span></code> variable is NOT optional - it must be specified or an error will be returned.</p></li>
</ul>
</li>
</ul>
</section>
<section id="alternate-job-submission-run-batch-general-py">
<h2>Alternate job submission: run_batch_general.py<a class="headerlink" href="#alternate-job-submission-run-batch-general-py" title="Permalink to this heading">#</a></h2>
<p>We also support an alternate second path besides <code class="docutils literal notranslate"><span class="pre">submitJobs</span></code> to create the list of jobs - the <code class="docutils literal notranslate"><span class="pre">run_batch_general.py</span></code> file.
This file essentially serves as a “shortcut” to run many common types of stereotyped experiments we run in our lab.
Essentially, if your data follows a regular structure (such as N rows, N columns, N grouping, a particular structure for output, etc.), you may find it useful to take and modify this file for your own usage.<br />
We recommend new users use the <code class="docutils literal notranslate"><span class="pre">submitJobs</span></code> pathway, as it will help users understand the kinds of information Distributed-CellProfiler needs in order to run properly, but once they are comfortable with it they may find <code class="docutils literal notranslate"><span class="pre">run_batch_general.py</span></code> helps them create jobs faster in the future.</p>
<p>As of Distributed-CellProfiler 2.2.0, <code class="docutils literal notranslate"><span class="pre">run_batch_general.py</span></code> has been reformatted as a CLI tool with greatly enhanced customizeability.
<code class="docutils literal notranslate"><span class="pre">run_batch_general.py</span></code> must be passed 5 pieces of information:</p>
<section id="required-inputs">
<h3>Required inputs<a class="headerlink" href="#required-inputs" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">step</span></code> is the step that you would like to make jobs for.
Supported steps are <code class="docutils literal notranslate"><span class="pre">zproj</span></code>, <code class="docutils literal notranslate"><span class="pre">illum</span></code>, <code class="docutils literal notranslate"><span class="pre">qc</span></code>, <code class="docutils literal notranslate"><span class="pre">qc_persite</span></code>, <code class="docutils literal notranslate"><span class="pre">assaydev</span></code>, and<code class="docutils literal notranslate"><span class="pre">analysis</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">identifier</span></code> is the project identifier (e.g. “cpg0000-jump-pilot” or “2024_11_07_Collaborator_Cell_Painting”)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">batch</span></code> is the name of the data batch (e.g. “2020_11_04_CPJUMP1”)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">platelist</span></code> is the list of plates to process.
Format the list in quotes with individual plates separated by commas and no spaces (e.g. “Plate1,Plate2,Plate3”)</p></li>
</ul>
<p>A minimal <code class="docutils literal notranslate"><span class="pre">run_batch_general.py</span></code> command may look like:
“””bash
run_batch_general.py analysis 2024_05_16_Segmentation_Project 2024_10_10_Batch1 “Plate1,Plate2,Plate3”
“””</p>
</section>
<section id="required-input-for-cell-painting-gallery">
<h3>Required input for Cell Painting Gallery<a class="headerlink" href="#required-input-for-cell-painting-gallery" title="Permalink to this heading">#</a></h3>
<p>Runs being made off of the Cell Painting Gallery require two additional flags:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--source</span> <span class="pre">&lt;value&gt;</span></code> to specify the identifier-specific source of the data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--path-style</span> <span class="pre">cpg</span></code> is to set the input and output paths as data is structured in the Cell Painting Gallery.
All paths can be overwritten with flags (see below).</p></li>
</ul>
<p>A minimal <code class="docutils literal notranslate"><span class="pre">run_batch_general.py</span></code> command for a dataset on the Cell Painting Gallery may look like:
“””bash
run_batch_general.py analysis cpg0000-jump-pilot 2020_11_04_CPJUMP1 “BR00116991,BR00116992” –path-style cpg –source broad
“””</p>
</section>
<section id="plate-layout-flags">
<h3>Plate layout flags<a class="headerlink" href="#plate-layout-flags" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--plate-format</span> <span class="pre">&lt;value&gt;</span></code>: if used, can be <code class="docutils literal notranslate"><span class="pre">96</span></code> or <code class="docutils literal notranslate"><span class="pre">384</span></code> and will overwrite <code class="docutils literal notranslate"><span class="pre">rows</span></code> and <code class="docutils literal notranslate"><span class="pre">columns</span></code> to produce standard 96- or 384-well plate well names (e.g. A01, A02, etc.)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--rows</span> <span class="pre">&lt;value&gt;</span></code>: a custom list of row labels.
Will be combined with <code class="docutils literal notranslate"><span class="pre">columns</span></code> to generate well names.
Separate values with commas and no spaces and surround with quotation marks (e.g. <code class="docutils literal notranslate"><span class="pre">&quot;A,B,C,D,E,F,G&quot;</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--columns</span> <span class="pre">&lt;value&gt;</span></code>: a custom list of column labels.
Will be combined with <code class="docutils literal notranslate"><span class="pre">rows</span></code> to generate well names.
Separate values with commas and no spaces and surround with quotation marks (e.g. <code class="docutils literal notranslate"><span class="pre">&quot;1,2,3,4,5,6,7,8,9,10&quot;</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--wells</span> <span class="pre">&lt;value&gt;</span></code>: a custom list of wells.
Overwrites <code class="docutils literal notranslate"><span class="pre">rows</span></code> and <code class="docutils literal notranslate"><span class="pre">columns</span></code>.
Separate values with commas and no spaces and surround with quotation marks (e.g. <code class="docutils literal notranslate"><span class="pre">&quot;C02,D04,E04,N12&quot;</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--no-well-digit-pad</span></code>: Formats wells without well digit padding.
Formats wells passed with <code class="docutils literal notranslate"><span class="pre">--plate</span> <span class="pre">format</span></code> or <code class="docutils literal notranslate"><span class="pre">--rows</span></code> and <code class="docutils literal notranslate"><span class="pre">--columns</span></code> but not <code class="docutils literal notranslate"><span class="pre">--wells</span></code>.
(e.g. <code class="docutils literal notranslate"><span class="pre">A1</span></code> NOT <code class="docutils literal notranslate"><span class="pre">A01</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--sites</span> <span class="pre">&lt;value&gt;</span></code>: a custom list of sites (fields of view) to be analyzed.
Default is 9 sites (1 to 9).
Not used by <code class="docutils literal notranslate"><span class="pre">illum</span></code>, <code class="docutils literal notranslate"><span class="pre">qc</span></code>, or <code class="docutils literal notranslate"><span class="pre">assaydev</span></code> steps.
Separate values with commas and no spaces and surround with quotation marks (e.g. <code class="docutils literal notranslate"><span class="pre">&quot;1,2,3,4,5,6&quot;</span></code>)</p></li>
</ul>
</section>
<section id="overwrite-structural-defaults">
<h3>Overwrite structural defaults<a class="headerlink" href="#overwrite-structural-defaults" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--output-structure</span> <span class="pre">&lt;value&gt;</span></code>: overwrite default output structure</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--output-path</span> <span class="pre">&lt;value&gt;</span></code>: overwrite default output path</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--input-path</span> <span class="pre">&lt;value&gt;</span></code>: overwrite the default path to input files</p></li>
</ul>
</section>
<section id="overwrite-defaults-for-runs-using-load-data-csv-s-and-cppipe">
<h3>Overwrite defaults (for runs using load data .csv’s and .cppipe)<a class="headerlink" href="#overwrite-defaults-for-runs-using-load-data-csv-s-and-cppipe" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--pipeline</span> <span class="pre">&lt;value&gt;</span></code>: overwrite the default pipeline name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--pipeline-path</span> <span class="pre">&lt;value&gt;</span></code>: overwrite the default path to pipelines</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--datafile-name</span> <span class="pre">&lt;value&gt;</span></code>: overwrite the default load data .csv name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--datafile-path</span> <span class="pre">&lt;value&gt;</span></code>: overwrite the default path to load data files</p></li>
</ul>
</section>
<section id="overwrite-defaults-for-runs-using-h5-batch-files">
<h3>Overwrite defaults (for runs using .h5 batch files)<a class="headerlink" href="#overwrite-defaults-for-runs-using-h5-batch-files" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--use-batch</span></code>: use h5 batch files instead of load data csv and .cppipe files</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--batchfile-name</span> <span class="pre">&lt;value&gt;</span></code>: overwrite default batchfile name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--batchfile-path</span> <span class="pre">&lt;value&gt;</span></code>: overwrite default path to the batchfile</p></li>
</ul>
</section>
</section>
<div class="toctree-wrapper compound">
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="SQS_QUEUE_information.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">SQS QUEUE Information</p>
      </div>
    </a>
    <a class="right-next"
       href="passing_files_to_DCP.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Passing Files to DCP</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configuring-your-job-file">Configuring your job file</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alternate-job-submission-run-batch-general-py">Alternate job submission: run_batch_general.py</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#required-inputs">Required inputs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#required-input-for-cell-painting-gallery">Required input for Cell Painting Gallery</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plate-layout-flags">Plate layout flags</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overwrite-structural-defaults">Overwrite structural defaults</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overwrite-defaults-for-runs-using-load-data-csv-s-and-cppipe">Overwrite defaults (for runs using load data .csv’s and .cppipe)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#overwrite-defaults-for-runs-using-h5-batch-files">Overwrite defaults (for runs using .h5 batch files)</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Broad Institute
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>