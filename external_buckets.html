

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Using External Buckets &#8212; DCP Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'external_buckets';</script>
    <link rel="canonical" href="distributedscience.github.io/external_buckets.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Advanced Configuration of DCP" href="advanced_configuration.html" />
    <link rel="prev" title="AWS Cloudwatch Dashboard" href="dashboard.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="overview.html">
  
  
  
  
  
  
    <p class="title logo__title">DCP Documentation</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="overview.html">
                    What is Distributed-CellProfiler?
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">FAQ</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="overview_2.html">What happens in AWS when I run Distributed-CellProfiler?</a></li>
<li class="toctree-l1"><a class="reference internal" href="costs.html">What does Distributed-CellProfiler cost?</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Running DCP</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="step_0_prep.html">Step 0: Prep</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="step_1_configuration.html">Step 1: Configuration</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="config_examples.html">config.py configuration examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="SQS_QUEUE_information.html">SQS QUEUE Information</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="step_2_submit_jobs.html">Step 2: Submit Jobs</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="passing_files_to_DCP.html">Passing Files to DCP</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="step_3_start_cluster.html">Step 3: Start Cluster</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting_start_cluster.html">Troubleshooting startCluster</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="step_4_monitor.html">Step 4: Monitor</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Technical Guides</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="dashboard.html">AWS Cloudwatch Dashboard</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Using External Buckets</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_configuration.html">Advanced Configuration of DCP</a></li>
<li class="toctree-l1"><a class="reference internal" href="AWS_hygiene_scripts.html">AWS Hygiene Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting_runs.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="versions.html">Versions</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/distributedscience/distributed-cellprofiler" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/distributedscience/distributed-cellprofiler/edit/main/DCP-documentation/external_buckets.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/distributedscience/distributed-cellprofiler/issues/new?title=Issue%20on%20page%20%2Fexternal_buckets.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/external_buckets.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Using External Buckets</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#config-setup">Config setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-configs">Example configs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-from-the-cell-painting-gallery">Reading from the Cell Painting Gallery</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#read-write-to-a-collaborator-s-bucket">Read/Write to a collaborator’s bucket</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#permissions-setup">Permissions setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-your-aws-account">In your AWS account</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-your-dcp-instance">In your DCP instance</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="using-external-buckets">
<h1>Using External Buckets<a class="headerlink" href="#using-external-buckets" title="Permalink to this heading">#</a></h1>
<p>Distributed-CellProfiler can read and/or write to/from an external S3 bucket (i.e. a bucket not in the same account as you are running DCP).
To do so, you will need to appropriately set your configuration in run.py.
You may need additional configuration in AWS Identity and Access Management (IAM).</p>
<section id="config-setup">
<h2>Config setup<a class="headerlink" href="#config-setup" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>AWS_PROFILE:</strong> The profile you use must have appropriate permissions for running DCP as well as read/write permissions for the external bucket.
See below for more information.</p></li>
<li><p><strong>AWS_BUCKET:</strong> The bucket to which you would like to write log files.
This is generally the bucket in the account in which you are running compute.</p></li>
<li><p><strong>SOURCE_BUCKET:</strong> The bucket where the files you will be reading are.
Often, this is the same as AWS_BUCKET.</p></li>
<li><p><strong>DESTINATION_BUCKET:</strong> The bucket where you want to write your output files.
Often, this is the same as AWS_BUCKET.</p></li>
<li><p><strong>UPLOAD_FLAGS:</strong> If you need to add flags to an AWS CLI command to upload flags to your DESTINATION_BUCKET, this is where you enter them.
This is typically only used if you are writing to a bucket that is not yours.
If you don’t need to add UPLOAD_FLAGS, keep it as the default ‘’.</p></li>
</ul>
</section>
<section id="example-configs">
<h2>Example configs<a class="headerlink" href="#example-configs" title="Permalink to this heading">#</a></h2>
<section id="reading-from-the-cell-painting-gallery">
<h3>Reading from the Cell Painting Gallery<a class="headerlink" href="#reading-from-the-cell-painting-gallery" title="Permalink to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">AWS_REGION</span> <span class="o">=</span> <span class="s1">&#39;your-region&#39;</span>              <span class="c1"># e.g. &#39;us-east-1&#39;</span>
<span class="n">AWS_PROFILE</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span>                 <span class="c1"># The same profile used by your AWS CLI installation</span>
<span class="n">SSH_KEY_NAME</span> <span class="o">=</span> <span class="s1">&#39;your-key-file.pem&#39;</span>      <span class="c1"># Expected to be in ~/.ssh</span>
<span class="n">AWS_BUCKET</span> <span class="o">=</span> <span class="s1">&#39;bucket-name&#39;</span>              <span class="c1"># Your bucket</span>
<span class="n">SOURCE_BUCKET</span> <span class="o">=</span> <span class="s1">&#39;cellpainting-gallery&#39;</span>  
<span class="n">WORKSPACE_BUCKET</span> <span class="o">=</span> <span class="s1">&#39;bucket-name&#39;</span>        <span class="c1"># Likely your bucket</span>
<span class="n">DESTINATION_BUCKET</span> <span class="o">=</span> <span class="s1">&#39;bucket-name&#39;</span>      <span class="c1"># Your bucket</span>
<span class="n">UPLOAD_FLAGS</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>                      
</pre></div>
</div>
</section>
<section id="read-write-to-a-collaborator-s-bucket">
<h3>Read/Write to a collaborator’s bucket<a class="headerlink" href="#read-write-to-a-collaborator-s-bucket" title="Permalink to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">AWS_REGION</span> <span class="o">=</span> <span class="s1">&#39;your-region&#39;</span>              <span class="c1"># e.g. &#39;us-east-1&#39;</span>
<span class="n">AWS_PROFILE</span> <span class="o">=</span> <span class="s1">&#39;role-permissions&#39;</span>        <span class="c1"># A profile with the permissions setup described above</span>
<span class="n">SSH_KEY_NAME</span> <span class="o">=</span> <span class="s1">&#39;your-key-file.pem&#39;</span>      <span class="c1"># Expected to be in ~/.ssh</span>
<span class="n">AWS_BUCKET</span> <span class="o">=</span> <span class="s1">&#39;bucket-name&#39;</span>              <span class="c1"># Your bucket</span>
<span class="n">SOURCE_BUCKET</span> <span class="o">=</span> <span class="s1">&#39;collaborator-bucket&#39;</span>  
<span class="n">WORKSPACE_BUCKET</span> <span class="o">=</span> <span class="s1">&#39;collaborator-bucket&#39;</span>
<span class="n">DESTINATION_BUCKET</span> <span class="o">=</span> <span class="s1">&#39;collaborator-bucket&#39;</span>    
<span class="n">UPLOAD_FLAGS</span> <span class="o">=</span> <span class="s1">&#39;--acl bucket-owner-full-control --metadata-directive REPLACE&#39;</span> <span class="c1"># Examples of flags that may be necessary</span>
</pre></div>
</div>
</section>
</section>
<section id="permissions-setup">
<h2>Permissions setup<a class="headerlink" href="#permissions-setup" title="Permalink to this heading">#</a></h2>
<p>If you are reading from a public bucket, no additional setup is necessary.
Note that, depending on the configuration of that bucket, you may not be able to mount the public bucket so you will need to set <code class="docutils literal notranslate"><span class="pre">DOWNLOAD_FILES='True'</span></code>.</p>
<p>If you are reading from a non-public bucket or writing to a bucket that is not yours, you wil need further permissions setup.
Often, access to someone else’s AWS account is handled through a role that can be assumed.
Learn more about AWS IAM roles <a class="reference external" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html">here</a>.
Your collaborator will define the access limits of the role within their AWS IAM.
You will also need to define role limits within your AWS IAM so that when you assume the role (giving you access to your collaborator’s resource), that role also has the appropriate permissions to run DCP.</p>
<section id="in-your-aws-account">
<h3>In your AWS account<a class="headerlink" href="#in-your-aws-account" title="Permalink to this heading">#</a></h3>
<p>In AWS IAM, for the role that has external bucket access, you will need to add all of the DCP permissions described in <a class="reference internal" href="step_0_prep.html"><span class="doc std std-doc">Step 0</span></a>.</p>
<p>You will also need to edit the trust relationship for the role so that ECS and EC2 can assume the role.
A template is as follows:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2012-10-17&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;Statement&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;Effect&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;Principal&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;AWS&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                    </span><span class="s2">&quot;arn:aws:iam::123456789123:user/image_analyst&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="s2">&quot;arn:aws:iam::123456789123:user/image_expert&quot;</span>
<span class="w">                </span><span class="p">],</span>
<span class="w">                </span><span class="nt">&quot;Service&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                    </span><span class="s2">&quot;ecs-tasks.amazonaws.com&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="s2">&quot;ec2.amazonaws.com&quot;</span>
<span class="w">                </span><span class="p">]</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;Action&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;sts:AssumeRole&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="in-your-dcp-instance">
<h3>In your DCP instance<a class="headerlink" href="#in-your-dcp-instance" title="Permalink to this heading">#</a></h3>
<p>DCP reads your AWS_PROFILE from your <span class="xref myst">control node</span>.
Edit your AWS CLI configuration files for assuming that role in your control node as follows:</p>
<p>In <code class="docutils literal notranslate"><span class="pre">~/.aws/config</span></code>, copy in the following text block at the bottom of the file, editing to your specifications, and save.</p>
<p>[profile access-collaborator]
role_arn = arn:aws:iam::123456789123:role/access-to-other-bucket
source_profile = my-account-profile
region = us-east-1
output = json</p>
<p>In <code class="docutils literal notranslate"><span class="pre">~/.aws/credentials</span></code>, copy in the following text block at the bottom of the file (filling in your access key info) and save.</p>
<p>[my-account-profile]
aws_access_key_id = ACCESS_KEY
aws_secret_access_key = SECRET_ACCESS_KEY</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="dashboard.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">AWS Cloudwatch Dashboard</p>
      </div>
    </a>
    <a class="right-next"
       href="advanced_configuration.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Advanced Configuration of DCP</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#config-setup">Config setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-configs">Example configs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-from-the-cell-painting-gallery">Reading from the Cell Painting Gallery</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#read-write-to-a-collaborator-s-bucket">Read/Write to a collaborator’s bucket</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#permissions-setup">Permissions setup</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-your-aws-account">In your AWS account</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-your-dcp-instance">In your DCP instance</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Broad Institute
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>